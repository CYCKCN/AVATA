{% extends 'base.html' %}

{% block head %}
<style>
	/* 页面上部搜索框的CSS */
	#searchheader{
		background-color: #0074BC;
		height: 12vh;
	}
	#searchemail {
		position: absolute;
		top: 1.7vh;
		right: 5vw;
		color: white;
		font-size: 2vh;
		font-weight: bold;
	}
	.input::placeholder {
		padding : 0 25vw;
	}
	.input:focus {
		background-color: white;
	}
	.input {
		position: absolute;
		top: 6vh;
		width: 90vw;
		height: 4vh;
		font-size: 2.5vh;
		padding: 0 5vw;
		margin: 0 5vw;
		border-radius: 2.5vh;
	}
	#searchBtn {
		position: absolute;
		top: 50.2vh;
		width: 10vw;
		height: 5vh;
		left: 82vw;
	}
	.search{
		position: absolute;
		top: 0;
		left: 0;
		opacity: 0;
		height: 10vw;
		width: 5vh;
		z-index: 10;
	}
	/* 页面的CSS:1.主要部分 */
	.roommain{
		padding: 0 3vw;
		height: 88vh;
		width: 100vw;
		background-color: #E5E5E5;
	}
	.searchsubhead{
		font-size: 3.5vw;
		font-weight: bold;
		padding: 1vh 0;
	}
	.roomgroup{
		display: flex;
		flex-direction: row;
		flex-wrap: wrap;
		justify-content: flex-start;
		align-items: stretch;
	}
	.room{
		height: 30vh;
		width: 43vw;
		margin-right: 4vw;
		border-radius: 2.9vw;
		filter: drop-shadow(2px 2px 5px rgba(0, 0, 0, 0.25));
		background-color: white;
	}
	.roomimg{
		width: 100%;
		height: 80%;
		border-radius: 2.9vw 2.9vw 0 0;
	}
	.roomtext{
		width: 100%;
		height: 20%;
		padding: 2% 6%;
	}
	.roomname{
		font-size: 3.3vw;
    	font-weight: 500;
	}
	.roomlift{
		font-size: 2.4vw;
		font-weight: 300;
	}
	.roomelse{
		display: flex;
		flex-direction: column;
		justify-content: flex-end;
		margin-left: auto;
		align-items: flex-end;
		position: relative;
		bottom: 80%;
	}
	.roomdate{
		position: relative;
		font-size: 2.4vw;
		font-weight: 300;
	}
	.roomtime{
		position: relative;
		font-size: 2.4vw;
		font-weight: 300;
	}
	.room-empty{
        margin: auto;
        text-align: center;
        font-style: normal;
        font-weight: 500;
        font-size: 2vh;
        padding-top: 5vh;
    }

	#searchfooter{
		position: absolute;
		height: 10vh;
		width: 100vw;
		bottom: 0;
		border-top: black 0.1vw solid;
		display: flex;
		flex-direction: row;
		flex-wrap: nowrap;
		align-content: center;
		justify-content: space-around;
		align-items: center;
	}
	.search-btn{
		display: flex;
		flex-direction: column;
		justify-content: flex-start;
		align-items: center;
	}
	.icon {
		height: 10vw;
		width: 5vh;
	}
	.btn-txt{
		font-size: 3vw;
	}
	.active{
		color: #0074BC;
	}
</style>
{% endblock %}

{% block content %}
<form method="post" id="search">
	<div id="searchheader">
		<div id="searchemail">{[userEmail]}</div>
		<div id="searchBox">
			<input class="input" type="text" placeholder="Room number" name="room_id" v-model="roomid"/>
		</div>
	</div>
	<div class="roommain" v-if="roomid=='5554'">
		<div class="searchsubhead">Result</div>
		<div class="roomgroup">
			<div class="room" v-on:click="goRoom($event, 5554)">
				<img class="roomimg" src="{{url_for('static',filename='images/test/room5554/IMG5554.png')}}" />
				<div class="roomtext">
					<div class="roomname">Room 5554</div>
					<div class="roomlift">Lift 27-28</div>
					<div class="roomelse">
						<div class="roomdate">August 21</div>
						<div class="roomtime">19:00-21:00</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="roommain" v-else>
		<div class="searchsubhead">My Booking</div>
		<div class="roomgroup">
			{% if roomInfo_book %}
                {% for k, v in roomInfo_book.items() %}
                <div class="room" v-on:click="goRoom($event, {{v.name}})">
                    <img class="roomimg" src="../../static/images/test/room{{v.name}}/_basic_upload.png" />
                    <div class="roomtext">
                        <div class="roomname">Room {{v.name}}</div>
                        <div class="roomlift">{{v.lift}}</div>
                        <div class="roomelse">
                            <!--
                            <div class="roomdate">{{v.date}}</div>
                            <div class="roomtime">{{v.time}}</div>
                            -->
                            <div class="roomdate">TBA</div>
                            <div class="roomtime">TBA</div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="room-empty">No room!</div>
            {% endif %}
		</div>
		<div class="searchsubhead">Recently</div>
		<div class="roomgroup">
			{% if roomInfo %}
                {% for k, v in roomInfo.items() %}
                <div class="room" v-on:click="goRoom($event, {{v.name}})">
                    <img class="roomimg" src="../../static/images/test/room{{v.name}}/_basic_upload.png" />
                    <div class="roomtext">
                        <div class="roomname">Room {{v.name}}</div>
                        <div class="roomlift">{{v.lift}}</div>
                        <div class="roomelse">
                            <!--
                            <div class="roomdate">{{v.date}}</div>
                            <div class="roomtime">{{v.time}}</div>
                            -->
                            <div class="roomdate">TBA</div>
                            <div class="roomtime">TBA</div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="room-empty">No room!</div>
            {% endif %}
		</div>
	</div>
	<div id="searchfooter">
		<div class="search-btn">
			<svg class="icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path d="M19.7266 17.293L15.832 13.3984C15.6562 13.2227 15.418 13.125 15.168 13.125H14.5312C15.6094 11.7461 16.25 10.0117 16.25 8.125C16.25 3.63672 12.6133 0 8.125 0C3.63672 0 0 3.63672 0 8.125C0 12.6133 3.63672 16.25 8.125 16.25C10.0117 16.25 11.7461 15.6094 13.125 14.5312V15.168C13.125 15.418 13.2227 15.6562 13.3984 15.832L17.293 19.7266C17.6602 20.0937 18.2539 20.0937 18.6172 19.7266L19.7227 18.6211C20.0898 18.2539 20.0898 17.6602 19.7266 17.293ZM8.125 13.125C5.36328 13.125 3.125 10.8906 3.125 8.125C3.125 5.36328 5.35937 3.125 8.125 3.125C10.8867 3.125 13.125 5.35937 13.125 8.125C13.125 10.8867 10.8906 13.125 8.125 13.125Z" :fill="isSelected == 1 ? '#0074BC': 'black'"/>
			</svg>
			<div class="btn-txt" v-bind:class="{ active: isSelected}">Room Search</div>
		</div>
		<div class="search-btn">
			<svg class="icon" width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path d="M14.583 12.5002H16.1455V15.4377L18.6872 16.9064L17.9059 18.2606L14.583 16.3439V12.5002ZM4.16634 2.0835H18.7497C19.3022 2.0835 19.8321 2.30299 20.2228 2.69369C20.6135 3.08439 20.833 3.6143 20.833 4.16683V10.521C22.1247 11.8335 22.9163 13.6356 22.9163 15.6252C22.9163 17.559 22.1481 19.4137 20.7807 20.7811C19.4132 22.1486 17.5585 22.9168 15.6247 22.9168C13.6351 22.9168 11.833 22.1252 10.5205 20.8335H4.16634C3.61381 20.8335 3.0839 20.614 2.6932 20.2233C2.3025 19.8326 2.08301 19.3027 2.08301 18.7502V4.16683C2.08301 3.6143 2.3025 3.08439 2.6932 2.69369C3.0839 2.30299 3.61381 2.0835 4.16634 2.0835ZM4.16634 15.6252V18.7502H9.03092C8.58301 17.8022 8.33301 16.7397 8.33301 15.6252H4.16634ZM4.16634 8.3335H10.4163V5.2085H4.16634V8.3335ZM18.7497 8.3335V5.2085H12.4997V8.3335H18.7497ZM4.16634 13.5418H8.63509C8.98926 12.3439 9.64551 11.271 10.5205 10.4168H4.16634V13.5418ZM15.6247 10.5731C14.2848 10.5731 12.9998 11.1054 12.0523 12.0528C11.1049 13.0002 10.5726 14.2853 10.5726 15.6252C10.5726 18.4168 12.833 20.6772 15.6247 20.6772C16.2881 20.6772 16.9451 20.5466 17.558 20.2927C18.171 20.0388 18.7279 19.6667 19.197 19.1975C19.6662 18.7284 20.0383 18.1715 20.2922 17.5585C20.5461 16.9456 20.6768 16.2886 20.6768 15.6252C20.6768 12.8335 18.4163 10.5731 15.6247 10.5731Z" :fill="isSelected == 0 ? '#0074BC': 'black'"/>
			</svg>
			<div class="btn-txt" v-bind:class="{ active: !isSelected}">Timetable</div>
		</div>
	</div>
</form>

<script>
	Vue.createApp({
	  data() {
		return {
		  userEmail: 'rose@gmail.com',
		  roomid: '',
		  isSelected: 1,  // 是否选中Room Search
		}
	  },
	  delimiters: ['{[', ']}'],  // Fix bug: Avoid Mustache syntax conflict in Vue and flask.jinjia2
	  methods: {
		goRoom: function (event, roomid) {
			console.log(event, roomid)
			var form = document.getElementById("search");
			form.submit();
		},
	  }
	}).mount('#search')
	</script>
{% endblock %}